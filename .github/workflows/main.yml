name: CI Pipeline - Main Workflow
on:
  #Trigger the workflow on push from the develop branch
  # label:
  #   types:
  #     - on-going work
  #     - test-only
  #     - sca-only
  #     - scan-only
  #     - test-only
  #     - buid-only
  push:
    branches:
      - feature-*
      - master
      - develop
    issues:
      types: [synchronize, opened, reopened, labeled, unlabeled]

jobs:
  call-sonar-workflow:
    if: github.event.label.name == 'bug'
    runs-on: ubuntu-latest
    steps:
      - run: echo 'The label was bug'

    # uses: BLOCK-AID/github-actions-template/.github/workflows/sonar.yml@feature-1
    # secrets:
    #   host: ${{ secrets.SONARQUBE_HOST }}
    #   login: ${{ secrets.SONARQUBE_TOKEN }}

  call-trivy-workflow:
    if: github.event.label.name == 'bug'
    runs-on: ubuntu-latest
    steps:
      - run: echo 'The label was bug'

    # uses: BLOCK-AID/github-actions-template/.github/workflows/trivy.yml@feature-1

  call-test-workflow:
    if: github.event.label.name == 'bug'
    runs-on: ubuntu-latest
    steps:
      - run: echo 'The label was bug'
    # uses: BLOCK-AID/github-actions-template/.github/workflows/test.yml@feature-1

  call-build-workflow:
    if: github.event.label.name == 'bug'
    runs-on: ubuntu-latest
    steps:
      - run: echo 'The label was bug'
    # uses: BLOCK-AID/github-actions-template/.github/workflows/build.yml@feature-1

  call-deploy-workflow:
    if: github.event.label.name == 'bug'
    runs-on: ubuntu-latest
    steps:
      - run: echo 'The label was bug'
    needs: call-build-workflow
    # uses: BLOCK-AID/github-actions-template/.github/workflows/deploy.yml@feature-1

